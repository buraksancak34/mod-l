<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒ∞lker & Derya - Bizim D√ºnyamƒ±z</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.youtube.com/iframe_api"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { rose: { 600: '#e11d48' }, pink: { 500: '#ec4899' }, slate: { 50: '#f8fafc' } },
                    fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'], romantic: ['"Dancing Script"', 'cursive'] },
                    animation: { 'spin-slow': 'spin 8s linear infinite' }
                }
            }
        }
    </script>

    <style>
        body { background: linear-gradient(135deg, #f8fafc 0%, #fff1f2 100%); min-height: 100vh; overflow-x: hidden; }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 8px 32px rgba(225, 29, 72, 0.05);
            border-radius: 1.5rem;
            transition: transform 0.3s ease;
        }
        
        /* Zarf Efekti */
        .envelope-card { cursor: pointer; position: relative; overflow: hidden; transition: all 0.3s ease; }
        .envelope-card:hover { transform: translateX(5px); background: #fff1f2; }
        
        .blur-lock { filter: blur(10px); pointer-events: none; user-select: none; }
        .unlocked { filter: blur(0); pointer-events: auto; transition: filter 0.8s ease; }

        /* Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #fda4af; border-radius: 4px; }
    </style>
</head>
<body class="text-slate-800 pb-24">

    <div id="toast" class="fixed bottom-24 left-1/2 -translate-x-1/2 bg-rose-900 text-white px-6 py-3 rounded-full shadow-2xl opacity-0 transition-opacity duration-300 z-[99999] text-sm font-bold pointer-events-none"></div>

    <div class="bg-white/80 border-b border-rose-100 py-3 text-center sticky top-0 z-40 backdrop-blur">
        <p id="top-motto" class="text-xs md:text-sm font-bold text-rose-500 tracking-widest uppercase animate-pulse">
            "Y√ºkleniyor..."
        </p>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <header class="flex flex-col md:flex-row justify-between items-center mb-12 gap-8">
            <div class="text-center md:text-left">
                <h1 class="font-romantic text-6xl md:text-7xl text-rose-600">ƒ∞lker <span class="text-4xl text-pink-400">&</span> Derya</h1>
                <p class="text-slate-400 font-medium mt-2 tracking-wide">Bizim D√ºnyamƒ±z</p>
            </div>
            
            <div class="flex gap-4">
                <div class="glass-card p-4 text-center min-w-[140px]">
                    <div class="text-[10px] text-rose-400 font-black uppercase">Evlilik</div>
                    <div id="counter-marriage" class="text-2xl font-black text-slate-700">...</div>
                    <div class="text-[9px] text-slate-400">G√ºn Oldu</div>
                </div>
                <div class="glass-card p-4 text-center min-w-[140px]">
                    <div class="text-[10px] text-rose-400 font-black uppercase">Tanƒ±≈üma</div>
                    <div id="counter-meeting" class="text-2xl font-black text-slate-700">...</div>
                    <div class="text-[9px] text-slate-400">G√ºn Oldu</div>
                </div>
            </div>
        </header>

        <section class="mb-16">
            <div class="glass-card max-w-3xl mx-auto p-10 text-center relative overflow-hidden">
                <h2 class="text-xs font-black text-rose-400 uppercase tracking-[0.3em] mb-6">G√ºn√ºn Mesajƒ±</h2>
                <p id="daily-message-display" class="font-romantic text-3xl md:text-4xl text-slate-700 leading-normal">
                    "Giri≈ü yapƒ±ldƒ±ƒüƒ±nda kalbimiz konu≈üacak..."
                </p>
                <div class="mt-8">
                    <button onclick="window.openLoginModal()" id="login-trigger-btn" class="bg-rose-500 text-white px-8 py-3 rounded-full text-xs font-bold uppercase shadow-lg hover:bg-rose-600 transition-all">
                        Giri≈ü Yap
                    </button>
                    <div id="user-info-panel" class="hidden flex flex-col items-center gap-2">
                        <div class="flex items-center gap-2">
                            <span id="welcome-text" class="text-sm font-bold text-rose-600"></span>
                            <button onclick="window.toggleAdmin()" id="admin-btn" class="hidden bg-slate-200 text-slate-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">‚öôÔ∏è</button>
                        </div>
                        <button onclick="window.logout()" class="text-[10px] text-slate-400 underline">√áƒ±kƒ±≈ü</button>
                    </div>
                </div>
            </div>
        </section>

        <div id="secure-layer" class="relative transition-all duration-1000 blur-lock">
            
            <div id="lock-overlay" class="absolute inset-0 z-30 flex flex-col items-center justify-center pt-20">
                <div class="text-6xl mb-4 opacity-50">üîí</div>
            </div>

            <div class="mb-12">
                <div class="bg-white rounded-3xl p-1 shadow-sm border border-rose-100">
                    <div class="bg-rose-50/50 rounded-[1.3rem] p-6 text-center h-40 flex flex-col justify-center relative overflow-hidden">
                        <div class="absolute top-0 left-1/2 -translate-x-1/2 bg-rose-200 text-rose-700 px-3 py-1 text-[9px] font-bold uppercase rounded-b-lg">‚ù§Ô∏è ƒ∞li≈üki Notlarƒ±</div>
                        <div class="swiper expertSwiper w-full h-full">
                            <div class="swiper-wrapper" id="expert-slides-wrapper">
                                </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-16">
                <div class="glass-card p-6 h-[500px] flex flex-col">
                    <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2">üíå Bizim Sohbetimiz</h3>
                    <div id="chat-container" class="flex-1 overflow-y-auto pr-2 space-y-3 mb-4 custom-scroll bg-white/40 rounded-xl p-4"></div>
                    <div class="flex gap-2">
                        <input type="text" id="chat-input" class="flex-1 bg-white border border-rose-100 rounded-xl px-4 text-sm outline-none focus:border-rose-400" placeholder="Bir not bƒ±rak...">
                        <button onclick="window.sendChat()" class="bg-rose-500 text-white w-10 h-10 rounded-xl flex items-center justify-center shadow-lg hover:bg-rose-600">‚û§</button>
                    </div>
                </div>

                <div class="glass-card p-6 h-[500px] flex flex-col">
                    <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2">üí´ Kalpten ƒ∞stekler</h3>
                    
                    <div class="flex-1 overflow-y-auto mb-4 custom-scroll pr-2">
                        <div class="mb-6">
                            <h4 class="text-[10px] font-black text-rose-400 uppercase mb-2">Sana Gelen Zarflar</h4>
                            <div id="incoming-requests" class="space-y-2"></div>
                        </div>
                        <div>
                            <h4 class="text-[10px] font-black text-slate-400 uppercase mb-2">Senin G√∂nderdiklerin</h4>
                            <div id="outgoing-requests" class="space-y-1"></div>
                        </div>
                    </div>

                    <div class="bg-pink-50 p-2 rounded-xl border border-pink-100 flex gap-2">
                        <input type="text" id="request-input" class="flex-1 bg-transparent text-sm outline-none px-2 placeholder-pink-300 text-pink-900" placeholder="Dilek tut...">
                        <button onclick="window.sendRequest()" class="bg-pink-500 text-white px-4 rounded-lg text-sm font-bold">+</button>
                    </div>
                </div>
            </div>

            <section class="mb-24">
                <div class="flex justify-between items-end mb-6 px-2">
                    <h2 class="text-2xl font-romantic text-slate-800">Anƒ±larƒ±mƒ±z</h2>
                    <button onclick="document.getElementById('memory-form').classList.toggle('hidden')" class="text-xs bg-white border border-rose-200 text-rose-500 px-4 py-2 rounded-full font-bold shadow-sm hover:bg-rose-50">+ ANI EKLE</button>
                </div>

                <div id="memory-form" class="hidden mb-6 bg-white p-6 rounded-3xl shadow-xl border border-rose-100">
                    <div class="grid grid-cols-1 gap-4">
                        <input type="date" id="mem-date" class="w-full text-sm p-3 bg-slate-50 rounded-xl outline-none">
                        <textarea id="mem-desc" placeholder="Bu anƒ±n hikayesi..." class="w-full text-sm p-3 bg-slate-50 rounded-xl outline-none h-20 resize-none"></textarea>
                        <input type="file" id="mem-file" accept="image/*" class="text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-rose-50 file:text-rose-700">
                        <button onclick="window.saveMemory()" class="w-full bg-rose-600 text-white py-3 rounded-xl font-bold uppercase tracking-wider shadow-lg">KAYDET</button>
                    </div>
                </div>

                <div class="swiper memorySwiper pb-12 px-4">
                    <div class="swiper-wrapper" id="memory-wrapper">
                         <div class="swiper-slide flex items-center justify-center bg-white h-60 rounded-2xl border border-rose-100">
                             <p class="text-slate-400 text-sm">Hen√ºz anƒ± eklenmedi...</p>
                         </div>
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
            </section>
        </div>
    </div>

    <div id="admin-sidebar" class="fixed top-0 right-0 h-full w-80 bg-white shadow-[0_0_40px_rgba(0,0,0,0.1)] transform translate-x-full transition-transform duration-300 z-[10000] p-6 overflow-y-auto">
        <div class="flex justify-between items-center mb-8">
            <h2 class="font-bold text-slate-800 text-lg">Y√∂netim Paneli</h2>
            <button onclick="window.toggleAdmin()" class="text-2xl text-slate-300 hover:text-rose-500">&times;</button>
        </div>
        
        <div class="space-y-8">
            <div class="bg-rose-50 p-4 rounded-2xl">
                <label class="text-[10px] font-black text-rose-400 block mb-2 uppercase">G√ºne √ñzel Mesaj</label>
                <input type="date" id="admin-quote-date" class="w-full bg-white p-2 rounded-lg mb-2 text-xs border border-rose-100">
                <textarea id="admin-quote-text" class="w-full bg-white p-2 rounded-lg mb-2 text-xs h-16 border border-rose-100" placeholder="Mesaj..."></textarea>
                <button onclick="window.saveAdminQuote()" class="w-full bg-rose-500 text-white py-2 rounded-lg text-xs font-bold shadow-md">KAYDET</button>
                
                <div class="mt-4 pt-4 border-t border-rose-200">
                    <h4 class="text-[9px] font-bold text-rose-400 uppercase mb-2">Kayƒ±tlƒ± G√ºnler</h4>
                    <div id="admin-quote-list" class="max-h-32 overflow-y-auto space-y-1"></div>
                </div>
            </div>

            <div class="bg-slate-50 p-4 rounded-2xl">
                <label class="text-[10px] font-black text-slate-400 block mb-2 uppercase">Yeni Motto</label>
                <input type="text" id="admin-motto-text" class="w-full bg-white p-2 rounded-lg mb-2 text-xs border border-slate-200" placeholder="Motto...">
                <button onclick="window.saveAdminMotto()" class="w-full bg-slate-700 text-white py-2 rounded-lg text-xs font-bold shadow-md">EKLE</button>
                
                <div class="mt-4 pt-4 border-t border-slate-200">
                    <h4 class="text-[9px] font-bold text-slate-400 uppercase mb-2">Mottolar</h4>
                    <div id="admin-motto-list" class="max-h-32 overflow-y-auto space-y-1"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="music-bar" class="fixed bottom-0 left-0 w-full bg-white/90 backdrop-blur-md border-t border-rose-100 p-3 flex justify-between items-center z-50 transform translate-y-full transition-transform duration-500">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-rose-100 rounded-full flex items-center justify-center animate-spin-slow text-rose-500 shadow-inner">üéµ</div>
            <div>
                <p id="song-name" class="text-xs font-bold text-slate-800">Y√ºkleniyor...</p>
                <p class="text-[10px] text-slate-400">Derya & ƒ∞lker Playlist</p>
            </div>
        </div>
        <div class="flex gap-4 pr-4">
            <button onclick="player.pauseVideo()" class="text-slate-400 hover:text-rose-600">II</button>
            <button onclick="player.playVideo()" class="text-rose-500 hover:scale-110 transition-transform text-xl">‚ñ∂</button>
            <button onclick="window.nextSong()" class="text-slate-400 hover:text-rose-600">‚è≠</button>
        </div>
        <div id="yt-player" class="hidden"></div>
    </div>

    <div id="login-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999] hidden flex items-center justify-center">
        <div class="bg-white p-8 rounded-[2rem] shadow-2xl w-80 text-center relative animate-bounce-in">
            <button onclick="document.getElementById('login-modal').classList.add('hidden')" class="absolute top-4 right-4 text-slate-300 text-xl">&times;</button>
            <h3 class="text-xl font-romantic text-rose-600 mb-6">Ho≈ü Geldiniz</h3>
            <input type="password" id="password-input" class="w-full text-center text-lg tracking-[5px] p-3 border-b-2 border-rose-100 outline-none focus:border-rose-500 mb-6 font-bold text-rose-900" placeholder="****">
            <button onclick="window.attemptLogin()" class="w-full bg-gradient-to-r from-rose-500 to-pink-500 text-white py-3 rounded-xl font-bold shadow-lg">Gƒ∞Rƒ∞≈û</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getFirestore, collection, doc, setDoc, addDoc, deleteDoc, onSnapshot, query, orderBy, getDoc } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCbIuOJeKNpJToMg2-PsblLtue-mzElUQY", 
            authDomain: "tezz-95f0d.firebaseapp.com",
            projectId: "tezz-95f0d",
            storageBucket: "tezz-95f0d.appspot.com",
            messagingSenderId: "87135277271",
            appId: "1:87135277271:web:49cc5d5ee7b473bfa7a092"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const APP_ID = 'bizim_dunyamiz_v2'; // Temiz ID

        // Varsayƒ±lan Veriler (Seed Data)
        const defaultMottos = [
            "Aile, sevginin ba≈üladƒ±ƒüƒ± yerdir.", 
            "Birlikte her ≈üey daha g√ºzel.", 
            "Sonsuzluƒüa kadar el ele.",
            "Evimiz kalbimizin olduƒüu yerdir."
        ];
        const defaultExperts = [
            "Birbirinize her g√ºn en az bir kez sarƒ±lƒ±n.", 
            "Birlikte g√ºlmek, en iyi terapidir.", 
            "K√º√ß√ºk s√ºrprizler a≈ükƒ± canlƒ± tutar.",
            "Sorunlarƒ± yataƒüa girmeden √ß√∂z√ºn.",
            "Ortak hayaller kurmaya devam edin.",
            "Dinlemek, konu≈ümaktan daha deƒüerlidir.",
            "Birbirinizin alanƒ±na saygƒ± duyun.",
            "Te≈üekk√ºr etmeyi unutmayƒ±n."
        ];

        let currentUser = localStorage.getItem('bizim_user');
        let mottos = [...defaultMottos];
        let quotes = {};

        // --- GLOBAL FONKSƒ∞YONLAR (WINDOW) ---
        
        window.openLoginModal = () => document.getElementById('login-modal').classList.remove('hidden');
        
        window.attemptLogin = () => {
            const pass = document.getElementById('password-input').value;
            let user = null;
            if (pass === '1881') user = 'Derya';
            else if (pass === '1992') user = 'ƒ∞lker';

            if (user) {
                currentUser = user;
                localStorage.setItem('bizim_user', user);
                document.getElementById('login-modal').classList.add('hidden');
                document.getElementById('password-input').value = '';
                showToast(`Ho≈ü geldin ${user} ‚ù§Ô∏è`);
                updateUI();
            } else {
                showToast('≈ûifre hatalƒ±!');
            }
        };

        window.logout = () => { localStorage.removeItem('bizim_user'); currentUser = null; location.reload(); };

        window.toggleAdmin = () => document.getElementById('admin-sidebar').classList.toggle('translate-x-full');

        // CHAT G√ñNDERME
        window.sendChat = async () => {
            const inp = document.getElementById('chat-input');
            if(!inp.value.trim() || !currentUser) return;
            try {
                await addDoc(collection(db, 'artifacts', APP_ID, 'chat'), {
                    text: inp.value,
                    sender: currentUser,
                    createdAt: Date.now()
                });
                inp.value = '';
            } catch(e) { console.error(e); showToast("Hata: " + e.message); }
        };

        // TALEP G√ñNDERME
        window.sendRequest = async () => {
            const inp = document.getElementById('request-input');
            if(!inp.value.trim() || !currentUser) return;
            const target = currentUser === 'ƒ∞lker' ? 'Derya' : 'ƒ∞lker';
            try {
                await addDoc(collection(db, 'artifacts', APP_ID, 'requests'), {
                    text: inp.value,
                    from: currentUser,
                    to: target,
                    createdAt: Date.now()
                });
                inp.value = '';
                showToast('Zarf g√∂nderildi üíå');
            } catch(e) { console.error(e); showToast("Hata olu≈ütu"); }
        };

        // ANI KAYDETME
        window.saveMemory = async () => {
            const date = document.getElementById('mem-date').value;
            const desc = document.getElementById('mem-desc').value;
            const file = document.getElementById('mem-file').files[0];

            if(!date || !desc || !file) return showToast('T√ºm alanlarƒ± doldurun!');
            
            const reader = new FileReader();
            reader.onload = async (e) => {
                try {
                    await addDoc(collection(db, 'artifacts', APP_ID, 'memories'), {
                        date, desc, image: e.target.result, addedBy: currentUser, createdAt: Date.now()
                    });
                    document.getElementById('memory-form').classList.add('hidden');
                    // Formu temizle
                    document.getElementById('mem-date').value = '';
                    document.getElementById('mem-desc').value = '';
                    document.getElementById('mem-file').value = '';
                    showToast('Anƒ± eklendi ‚ú®');
                } catch(err) {
                    console.error(err);
                    showToast("Anƒ± kaydedilemedi!");
                }
            };
            reader.readAsDataURL(file);
        };

        // ADMIN: S√ñZ KAYDETME
        window.saveAdminQuote = async () => {
            const d = document.getElementById('admin-quote-date').value;
            const t = document.getElementById('admin-quote-text').value;
            if(!d || !t) return showToast("Tarih ve mesaj se√ßin");
            const key = d.split('-').reverse().slice(0,2).join('-');
            await setDoc(doc(db, 'artifacts', APP_ID, 'quotes', key), { text: t });
            showToast('Mesaj kaydedildi');
            document.getElementById('admin-quote-text').value = '';
        };

        // ADMIN: S√ñZ Sƒ∞LME
        window.deleteAdminQuote = async (key) => {
             await deleteDoc(doc(db, 'artifacts', APP_ID, 'quotes', key));
             showToast('Silindi');
        }

        // ADMIN: MOTTO KAYDETME
        window.saveAdminMotto = async () => {
             const t = document.getElementById('admin-motto-text').value;
             if(!t) return;
             const newList = [...mottos, t];
             await setDoc(doc(db, 'artifacts', APP_ID, 'config', 'mottos'), { list: newList });
             showToast('Motto eklendi');
             document.getElementById('admin-motto-text').value = '';
        }
        
        // ADMIN: MOTTO Sƒ∞LME
        window.deleteAdminMotto = async (idx) => {
            const newList = mottos.filter((_, i) => i !== idx);
            await setDoc(doc(db, 'artifacts', APP_ID, 'config', 'mottos'), { list: newList });
            showToast('Motto silindi');
        }


        // --- UI & LOGIC ---
        function updateUI() {
            const secureLayer = document.getElementById('secure-layer');
            const lockOverlay = document.getElementById('lock-overlay');
            const loginTrigger = document.getElementById('login-trigger-btn');
            const userInfo = document.getElementById('user-info-panel');
            
            if (currentUser) {
                secureLayer.classList.remove('blur-lock');
                secureLayer.classList.add('unlocked');
                lockOverlay.classList.add('hidden');
                loginTrigger.classList.add('hidden');
                userInfo.classList.remove('hidden');
                document.getElementById('welcome-text').innerText = currentUser;
                
                if (currentUser === 'ƒ∞lker') {
                    document.getElementById('admin-btn').classList.remove('hidden');
                }
                displayDailyQuote(); 
            } else {
                secureLayer.classList.add('blur-lock');
                secureLayer.classList.remove('unlocked');
                lockOverlay.classList.remove('hidden');
                loginTrigger.classList.remove('hidden');
                userInfo.classList.add('hidden');
            }
        }

        function displayDailyQuote() {
            const now = new Date();
            const key = `${String(now.getDate()).padStart(2,'0')}-${String(now.getMonth()+1).padStart(2,'0')}`;
            const el = document.getElementById('daily-message-display');
            
            if (quotes[key]) {
                el.innerText = `"${quotes[key]}"`;
            } else {
                const defaultQuotes = ["Seni √ßok seviyorum.", "ƒ∞yi ki varsƒ±n.", "Her g√ºn√ºm seninle g√ºzel."];
                const dayOfYear = Math.floor((now - new Date(now.getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);
                el.innerText = `"${defaultQuotes[dayOfYear % defaultQuotes.length]}"`;
            }
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.classList.remove('opacity-0');
            setTimeout(() => t.classList.add('opacity-0'), 3000);
        }

        // --- DATA LISTENER START ---
        
        // 1. Mottos
        onSnapshot(doc(db, 'artifacts', APP_ID, 'config', 'mottos'), (docSnap) => {
            if(docSnap.exists() && docSnap.data().list) {
                 mottos = docSnap.data().list;
            } else {
                 mottos = defaultMottos; // Veritabanƒ± bo≈üsa varsayƒ±lanlarƒ± kullan
            }
            // √ústteki mottonun d√∂nmesini saƒüla
            const mottoEl = document.getElementById('top-motto');
            mottoEl.innerText = `"${mottos[Math.floor(Math.random() * mottos.length)]}"`;
            
            // Admin listesini g√ºncelle
            if(currentUser === 'ƒ∞lker') {
                document.getElementById('admin-motto-list').innerHTML = mottos.map((m, i) => `
                    <div class="flex justify-between text-[10px] bg-white p-1 rounded border border-slate-100">
                        <span class="truncate w-32">${m}</span>
                        <button onclick="window.deleteAdminMotto(${i})" class="text-rose-500 font-bold">x</button>
                    </div>
                `).join('');
            }
        });

        // 2. Expert Tips (ƒ∞li≈üki Ko√ßu)
        onSnapshot(doc(db, 'artifacts', APP_ID, 'config', 'experts'), (docSnap) => {
            let tips = defaultExperts;
            if(docSnap.exists() && docSnap.data().list) {
                tips = docSnap.data().list;
            }
            
            const wrapper = document.getElementById('expert-slides-wrapper');
            wrapper.innerHTML = tips.map(t => 
                `<div class="swiper-slide flex items-center justify-center px-6"><p class="text-rose-800 italic font-medium leading-relaxed text-sm md:text-base">"${t}"</p></div>`
            ).join('');
            
            if(window.exSwiper) window.exSwiper.destroy();
            window.exSwiper = new Swiper(".expertSwiper", { direction: "vertical", autoplay: { delay: 4000 }, loop: true });
        });

        // 3. G√ºnl√ºk S√∂zler
        onSnapshot(collection(db, 'artifacts', APP_ID, 'quotes'), (snap) => {
            quotes = {};
            snap.docs.forEach(d => quotes[d.id] = d.data().text);
            displayDailyQuote();
            
            // Admin Listesi
             if(currentUser === 'ƒ∞lker') {
                document.getElementById('admin-quote-list').innerHTML = Object.keys(quotes).sort().map(k => `
                    <div class="flex justify-between text-[10px] bg-white p-1 rounded border border-rose-100">
                        <span><b>${k}:</b> ${quotes[k].substring(0,15)}...</span>
                        <button onclick="window.deleteAdminQuote('${k}')" class="text-rose-500 font-bold">x</button>
                    </div>
                `).join('');
            }
        });

        // 4. Chat
        onSnapshot(query(collection(db, 'artifacts', APP_ID, 'chat'), orderBy('createdAt', 'asc')), (snap) => {
            const div = document.getElementById('chat-container');
            div.innerHTML = snap.docs.map(d => {
                const m = d.data();
                const isMe = m.sender === currentUser;
                return `
                    <div class="flex ${isMe ? 'justify-end' : 'justify-start'}">
                        <div class="${isMe ? 'bg-rose-500 text-white' : 'bg-white border border-rose-100 text-slate-600'} rounded-2xl px-4 py-2 text-xs md:text-sm max-w-[85%] shadow-sm">
                            <p>${m.text}</p>
                            <span class="text-[9px] opacity-70 block text-right mt-1">${new Date(m.createdAt).toLocaleTimeString('tr-TR', {hour:'2-digit', minute:'2-digit'})}</span>
                        </div>
                    </div>`;
            }).join('');
            div.scrollTop = div.scrollHeight;
        });

        // 5. Talepler
        onSnapshot(query(collection(db, 'artifacts', APP_ID, 'requests'), orderBy('createdAt', 'desc')), (snap) => {
            if(!currentUser) return;
            const myName = currentUser;
            const incoming = [];
            const outgoing = [];

            snap.docs.forEach(d => {
                const data = d.data();
                if (data.to === myName) incoming.push(data);
                if (data.from === myName) outgoing.push(data);
            });

            const incDiv = document.getElementById('incoming-requests');
            if(incoming.length === 0) incDiv.innerHTML = '<div class="text-[10px] text-slate-300 italic">Zarf kutun bo≈ü...</div>';
            else {
                incDiv.innerHTML = incoming.map(r => `
                    <div class="envelope-card bg-white p-3 rounded-xl border border-rose-100 shadow-sm" onclick="alert('${r.text}')">
                        <div class="font-bold text-xs text-rose-500 mb-1 flex items-center gap-2">üì© ${r.from}'dan Mesaj</div>
                        <div class="text-[10px] text-slate-400">Okumak i√ßin tƒ±kla</div>
                    </div>
                `).join('');
            }

            document.getElementById('outgoing-requests').innerHTML = outgoing.map(r => `
                <div class="flex justify-between items-center text-[10px] text-slate-500 border-b border-slate-50 p-1">
                    <span class="truncate w-3/4">${r.text}</span>
                    <span class="text-rose-300">‚úì</span>
                </div>
            `).join('');
        });

        // 6. Anƒ±lar
        onSnapshot(collection(db, 'artifacts', APP_ID, 'memories'), (snap) => {
            if(snap.empty) {
                // Bo≈üsa varsayƒ±lan kartƒ± bƒ±rak
                return;
            }
            const mems = snap.docs.map(d => ({id: d.id, ...d.data()}));
            
            // Sƒ±ralama Algoritmasƒ±
            const today = new Date();
            mems.sort((a, b) => {
                const dateA = new Date(a.date);
                const dateB = new Date(b.date);
                dateA.setFullYear(today.getFullYear());
                dateB.setFullYear(today.getFullYear());
                if (dateA < today) dateA.setFullYear(today.getFullYear() + 1);
                if (dateB < today) dateB.setFullYear(today.getFullYear() + 1);
                return (dateA - today) - (dateB - today);
            });

            const wrapper = document.getElementById('memory-wrapper');
            wrapper.innerHTML = mems.map(m => `
                <div class="swiper-slide">
                    <div class="bg-white rounded-3xl overflow-hidden shadow-lg h-72 w-full relative group border border-rose-50">
                        <img src="${m.image}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                        <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-rose-900/90 to-transparent p-6 text-white pt-12">
                            <div class="font-bold text-lg font-romantic mb-1">${new Date(m.date).toLocaleDateString('tr-TR', {day:'numeric', month:'long', year:'numeric'})}</div>
                            <p class="text-xs opacity-90 line-clamp-2 italic">"${m.desc}"</p>
                        </div>
                    </div>
                </div>
            `).join('');
            
            if(window.memSwiperInstance) window.memSwiperInstance.destroy();
            window.memSwiperInstance = new Swiper(".memorySwiper", {
                effect: "cards", grabCursor: true, centeredSlides: true, slidesPerView: "auto",
            });
        });

        // SAYA√áLAR
        const mDate = new Date('2019-10-27');
        const tDate = new Date('2011-12-10');
        setInterval(() => {
            const now = new Date();
            document.getElementById('counter-marriage').innerText = Math.floor((now - mDate) / 86400000);
            document.getElementById('counter-meeting').innerText = Math.floor((now - tDate) / 86400000);
        }, 1000);

        // M√úZƒ∞K
        window.player = null;
        window.playlist = [
             {id: 'hUB9M88kAdI', title: 'Ho≈ü Geldin - Sezen Aksu'}, 
             {id: '7VUu1TuDjRI', title: 'Beni Sen ƒ∞nandƒ±r - Pinhani'}
        ];
        window.currentSong = 0;

        window.onYouTubeIframeAPIReady = () => {
             window.player = new YT.Player('yt-player', {
                height: '0', width: '0',
                videoId: window.playlist[0].id,
                events: {
                    'onReady': (event) => {
                        document.getElementById('music-bar').classList.remove('translate-y-full');
                        updateSongTitle();
                         // Auto play is blocked by browsers usually, needs interaction
                         document.body.addEventListener('click', () => {
                             if(player.getPlayerState() !== 1) player.playVideo();
                         }, { once: true });
                    }
                }
            });
        };
        
        window.nextSong = () => {
            window.currentSong = (window.currentSong + 1) % window.playlist.length;
            window.player.loadVideoById(window.playlist[window.currentSong].id);
            updateSongTitle();
        }
        
        function updateSongTitle() {
            document.getElementById('song-name').innerText = window.playlist[window.currentSong].title;
        }

        // Ba≈ülangƒ±√ß Kontrol√º
        updateUI();

    </script>
</body>
</html>
